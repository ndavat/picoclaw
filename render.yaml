services:
  - type: web
    name: picoclaw-openrouter
    env: docker
    branch: render-openrouter-deploy
    dockerfilePath: Dockerfile.render
    plan: free
    autoDeploy: true
    # Ensure PicoClaw uses OpenRouter model and provider rather than the default glm-4.7
    envVars:
      - key: MODEL_NAME
        value: openrouter/auto
      - key: PORT
        value: "8080"
      - key: TZ
        value: America/Chicago
      - key: PICOCLAW_AGENTS_DEFAULTS_MODEL
        value: openrouter/auto
      - key: PICOCLAW_AGENTS_DEFAULTS_PROVIDER
        value: openrouter
      # Secrets â€” set these in the Render dashboard (do NOT store real keys in repo)
      - key: OPENROUTER_API_KEY
        value: "<set-in-render-dashboard>"
      - key: PICOCLAW_CHANNELS_TELEGRAM_ENABLED
        value: "true"
      - key: PICOCLAW_CHANNELS_TELEGRAM_TOKEN
        value: "<set-in-render-dashboard>"
    # Start the lightweight render server binary (avoid running full `picoclaw` gateway)
    startCommand: "/usr/local/bin/picoclaw-render"
    routes:
      - type: web
  # Cron job to keep free-tier Render web services awake by pinging /health
cron:
  - name: keep-awake
    # Run every 14 minutes (keeps the service from idling past ~15 minutes)
    schedule: "*/14 * * * *"
    env: docker
    dockerfilePath: Dockerfile.render
    # Pings the /health endpoint to keep free-tier service from idling
    startCommand: >
      sh -lc "curl -fsS --max-time 10 http://0.0.0.0:18790/health || true"
